{% extends "base.html" %}
{% load static %}

{% block title %}Inicio • Monstromart{% endblock %}

{% block content %}
{% if not user.is_authenticated %}
  <!-- Hero Section para usuarios no autenticados -->
  <div class="text-center py-5" style="background: linear-gradient(135deg, #E4002B 0%, #B8001F 100%); color: white; border-radius: 15px; margin-bottom: 3rem;">
    <div class="container py-5">
      <h1 class="display-3 fw-bold mb-4">Bienvenido a MONSTROMART</h1>
      <p class="lead mb-5">Iniciá sesión para comprar, vender o intercambiar productos</p>
      
      <div class="d-flex justify-content-center gap-3 flex-wrap">
        <a href="{% url 'account_login' %}" class="btn btn-light btn-lg text-danger fw-bold">
          <i class="bi bi-box-arrow-in-right me-2"></i>Iniciar Sesión
        </a>
        <a href="{% url 'account_signup' %}" class="btn btn-outline-light btn-lg">
          <i class="bi bi-person-plus me-2"></i>Registrarse
        </a>
        <a href="{% url 'google_login' %}" class="btn btn-outline-light btn-lg border-2">
          <i class="fab fa-google me-2"></i>Continuar con Google
        </a>
      </div>
    </div>
  </div>

  <!-- Características del marketplace -->
  <div class="container">
    <div class="row g-4 text-center">
      <div class="col-md-4">
        <div class="p-4">
          <i class="bi bi-shield-check text-danger fs-1 mb-3"></i>
          <h4 class="fw-bold">Compra Segura</h4>
          <p class="text-muted">Transacciones protegidas y verificadas</p>
        </div>
      </div>
      <div class="col-md-4">
        <div class="p-4">
          <i class="bi bi-truck text-danger fs-1 mb-3"></i>
          <h4 class="fw-bold">Envío Rápido</h4>
          <p class="text-muted">Entrega a todo el país</p>
        </div>
      </div>
      <div class="col-md-4">
        <div class="p-4">
          <i class="bi bi-arrow-repeat text-danger fs-1 mb-3"></i>
          <h4 class="fw-bold">Intercambios</h4>
          <p class="text-muted">Trueques fáciles y seguros</p>
        </div>
      </div>
    </div>
  </div>

{% else %}
  <!-- BANNER CAROUSEL DE OFERTAS -->
  <div id="offersCarousel" class="carousel slide mb-5" data-bs-ride="carousel">
    <div class="carousel-indicators">
      <button type="button" data-bs-target="#offersCarousel" data-bs-slide-to="0" class="active"></button>
      <button type="button" data-bs-target="#offersCarousel" data-bs-slide-to="1"></button>
      <button type="button" data-bs-target="#offersCarousel" data-bs-slide-to="2"></button>
    </div>
    
    <div class="carousel-inner rounded-4 shadow">
      <!-- Slide 1 - Bebidas (ROJO) -->
      <div class="carousel-item active">
        <a href="{% url 'productos:product_list' %}?category=bebidas" class="text-decoration-none">
          <div class="banner-slide" style="background: linear-gradient(135deg, #E4002B 0%, #B8001F 100%); cursor: pointer;">
            <div class="container">
              <div class="row align-items-center py-5">
                <div class="col-md-6 text-white">
                  <h1 class="display-4 fw-bold mb-3">Que el calor te encuentre preparado</h1>
                  <div class="discount-badge mb-4">
                    <span class="display-1 fw-bold">50%</span>
                    <span class="fs-4">DTO</span>
                    <p class="mb-0 mt-2">EN LA 2DA UNIDAD</p>
                  </div>
                  <p class="mb-4">Promoción válida del 10 al 16 de noviembre</p>
                  <span class="btn btn-light btn-lg text-danger fw-bold banner-btn">
                    <i class="bi bi-cart-plus me-2"></i>Ver Ofertas
                  </span>
                </div>
                <div class="col-md-6 text-center position-relative">
                  <i class="bi bi-droplet-fill text-white opacity-25" style="font-size: 20rem;"></i>
                </div>
              </div>
            </div>
          </div>
        </a>
      </div>

      <!-- Slide 2 - Almacén (NARANJA) -->
      <div class="carousel-item">
        <a href="{% url 'productos:product_list' %}?category=almacen" class="text-decoration-none">
          <div class="banner-slide" style="background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%); cursor: pointer;">
            <div class="container">
              <div class="row align-items-center py-5">
                <div class="col-md-6 text-white">
                  <h1 class="display-4 fw-bold mb-3">Super descuentos en almacén</h1>
                  <div class="discount-badge mb-4" style="color: #FF6B35;">
                    <span class="display-1 fw-bold">40%</span>
                    <span class="fs-4">OFF</span>
                    <p class="mb-0 mt-2">EN PRODUCTOS SELECCIONADOS</p>
                  </div>
                  <p class="mb-4">Aprovechá las mejores ofertas del mes</p>
                  <span class="btn btn-light btn-lg fw-bold banner-btn" style="color: #FF6B35;">
                    <i class="bi bi-bag-check me-2"></i>Comprar Ahora
                  </span>
                </div>
                <div class="col-md-6 text-center position-relative">
                  <i class="bi bi-basket3-fill text-white opacity-25" style="font-size: 20rem;"></i>
                </div>
              </div>
            </div>
          </div>
        </a>
      </div>

      <!-- Slide 3 - Frutas y Verduras (VERDE) -->
      <div class="carousel-item">
        <a href="{% url 'productos:product_list' %}?category=frutas" class="text-decoration-none">
          <div class="banner-slide" style="background: linear-gradient(135deg, #28B463 0%, #1E8449 100%); cursor: pointer;">
            <div class="container">
              <div class="row align-items-center py-5">
                <div class="col-md-6 text-white">
                  <h1 class="display-4 fw-bold mb-3">Frescura garantizada</h1>
                  <div class="discount-badge mb-4" style="color: #28B463;">
                    <span class="display-1 fw-bold">2x1</span>
                    <p class="mb-0 mt-2">EN FRUTAS Y VERDURAS</p>
                  </div>
                  <p class="mb-4">Los productos más frescos al mejor precio</p>
                  <span class="btn btn-light btn-lg fw-bold banner-btn" style="color: #28B463;">
                    <i class="bi bi-cart-check me-2"></i>Ver Productos
                  </span>
                </div>
                <div class="col-md-6 text-center position-relative">
                  <i class="bi bi-apple text-white opacity-25" style="font-size: 20rem;"></i>
                </div>
              </div>
            </div>
          </div>
        </a>
      </div>
    </div>
    
    <button class="carousel-control-prev" type="button" data-bs-target="#offersCarousel" data-bs-slide="prev">
      <span class="carousel-control-prev-icon"></span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#offersCarousel" data-bs-slide="next">
      <span class="carousel-control-next-icon"></span>
    </button>
  </div>

  <!-- SECCIÓN DE CATEGORÍAS DESTACADAS -->
  <div class="container mb-5">
    <h2 class="fw-bold mb-4 text-center">
      <i class="bi bi-grid-3x3-gap text-danger me-2"></i>Comprá por categoría
    </h2>
    
    <div class="row g-4">
      <!-- Categoría 1 - Carnes y Pescados -->
      <div class="col-md-4">
        <a href="{% url 'productos:product_list' %}?category=carnes" class="text-decoration-none">
          <div class="category-card">
            <div class="category-image" style="background: linear-gradient(135deg, rgba(231, 76, 60, 0.9), rgba(192, 57, 43, 0.9)), url('https://images.unsplash.com/photo-1607623814075-e51df1bdc82f?w=800') center/cover;">
              <div class="category-overlay">
                <i class="bi bi-shop fs-1 mb-3"></i>
                <h3 class="fw-bold">Carnes y Pescados</h3>
                <p class="mb-0">Lo mejor del mar y campo</p>
              </div>
            </div>
          </div>
        </a>
      </div>

      <!-- Categoría 2 - Frutas y Verduras -->
      <div class="col-md-4">
        <a href="{% url 'productos:product_list' %}?category=frutas" class="text-decoration-none">
          <div class="category-card">
            <div class="category-image" style="background: linear-gradient(135deg, rgba(46, 204, 113, 0.9), rgba(39, 174, 96, 0.9)), url('https://images.unsplash.com/photo-1540420773420-3366772f4999?w=800') center/cover;">
              <div class="category-overlay">
                <i class="bi bi-basket2 fs-1 mb-3"></i>
                <h3 class="fw-bold">Frutas y Verduras</h3>
                <p class="mb-0">Frescura de selección</p>
              </div>
            </div>
          </div>
        </a>
      </div>

      <!-- Categoría 3 - Lácteos y Huevos -->
      <div class="col-md-4">
        <a href="{% url 'productos:product_list' %}?category=lacteos" class="text-decoration-none">
          <div class="category-card">
            <div class="category-image" style="background: linear-gradient(135deg, rgba(52, 152, 219, 0.9), rgba(41, 128, 185, 0.9)), url('https://images.unsplash.com/photo-1563636619-e9143da7973b?w=800') center/cover;">
              <div class="category-overlay">
                <i class="bi bi-egg-fried fs-1 mb-3"></i>
                <h3 class="fw-bold">Lácteos y Huevos</h3>
                <p class="mb-0">Leche, quesos y más</p>
              </div>
            </div>
          </div>
        </a>
      </div>

      <!-- Categoría 4 - Desayuno y Cereales -->
      <div class="col-md-4">
        <a href="{% url 'productos:product_list' %}?category=desayuno" class="text-decoration-none">
          <div class="category-card">
            <div class="category-image" style="background: linear-gradient(135deg, rgba(241, 196, 15, 0.9), rgba(243, 156, 18, 0.9)), url('https://images.unsplash.com/photo-1525351326368-efbb5cb6814d?w=800') center/cover;">
              <div class="category-overlay">
                <i class="bi bi-sunrise fs-1 mb-3"></i>
                <h3 class="fw-bold">Desayuno y Cereales</h3>
                <p class="mb-0">Empezá el día con energía</p>
              </div>
            </div>
          </div>
        </a>
      </div>

      <!-- Categoría 5 - Bebidas -->
      <div class="col-md-4">
        <a href="{% url 'productos:product_list' %}?category=bebidas" class="text-decoration-none">
          <div class="category-card">
            <div class="category-image" style="background: linear-gradient(135deg, rgba(155, 89, 182, 0.9), rgba(142, 68, 173, 0.9)), url('https://images.unsplash.com/photo-1513558161293-cdaf765ed2fd?w=800') center/cover;">
              <div class="category-overlay">
                <i class="bi bi-cup-straw fs-1 mb-3"></i>
                <h3 class="fw-bold">Bebidas</h3>
                <p class="mb-0">Refrescate este verano</p>
              </div>
            </div>
          </div>
        </a>
      </div>

      <!-- Categoría 6 - Panadería -->
      <div class="col-md-4">
        <a href="{% url 'productos:product_list' %}?category=panaderia" class="text-decoration-none">
          <div class="category-card">
            <div class="category-image" style="background: linear-gradient(135deg, rgba(211, 84, 0, 0.9), rgba(192, 57, 43, 0.9)), url('https://images.unsplash.com/photo-1509440159596-0249088772ff?w=800') center/cover;">
              <div class="category-overlay">
                <i class="bi bi-cake2 fs-1 mb-3"></i>
                <h3 class="fw-bold">Panadería</h3>
                <p class="mb-0">Pan fresco del día</p>
              </div>
            </div>
          </div>
        </a>
      </div>

      <!-- Categoría 7 - Snacks y Golosinas -->
      <div class="col-md-4">
        <a href="{% url 'productos:product_list' %}?category=snacks" class="text-decoration-none">
          <div class="category-card">
            <div class="category-image" style="background: linear-gradient(135deg, rgba(230, 126, 34, 0.9), rgba(211, 84, 0, 0.9)), url('https://images.unsplash.com/photo-1621939514649-280e2ee25f60?w=800') center/cover;">
              <div class="category-overlay">
                <i class="bi bi-gift fs-1 mb-3"></i>
                <h3 class="fw-bold">Snacks y Golosinas</h3>
                <p class="mb-0">Para picar rico</p>
              </div>
            </div>
          </div>
        </a>
      </div>

      <!-- Categoría 8 - Congelados -->
      <div class="col-md-4">
        <a href="{% url 'productos:product_list' %}?category=congelados" class="text-decoration-none">
          <div class="category-card">
            <div class="category-image" style="background: linear-gradient(135deg, rgba(93, 173, 226, 0.9), rgba(52, 152, 219, 0.9)), url('https://images.unsplash.com/photo-1476124369491-c2a1876cd5c8?w=800') center/cover;">
              <div class="category-overlay">
                <i class="bi bi-snow fs-1 mb-3"></i>
                <h3 class="fw-bold">Congelados</h3>
                <p class="mb-0">Prácticos y deliciosos</p>
              </div>
            </div>
          </div>
        </a>
      </div>

      <!-- Categoría 9 - Limpieza -->
      <div class="col-md-4">
        <a href="{% url 'productos:product_list' %}?category=limpieza" class="text-decoration-none">
          <div class="category-card">
            <div class="category-image" style="background: linear-gradient(135deg, rgba(26, 188, 156, 0.9), rgba(22, 160, 133, 0.9)), url('https://images.unsplash.com/photo-1563453392212-326f5e854473?w=800') center/cover;">
              <div class="category-overlay">
                <i class="bi bi-spray-can fs-1 mb-3"></i>
                <h3 class="fw-bold">Limpieza</h3>
                <p class="mb-0">Todo para tu hogar</p>
              </div>
            </div>
          </div>
        </a>
      </div>
    </div>
  </div>

  <!-- MEDIOS DE PAGO Y BENEFICIOS -->
  <div class="container mb-5">
    <div class="row g-4">
      <!-- American Express -->
      <div class="col-md-4">
        <div class="benefit-card p-4">
          <div class="d-flex align-items-center mb-3">
            <i class="bi bi-credit-card text-danger fs-2 me-3"></i>
            <div>
              <h5 class="fw-bold mb-1">25%</h5>
              <p class="text-muted small mb-0">Ver legales</p>
            </div>
          </div>
          <p class="small mb-0">Comprá cuando quieras y programá tu entrega los días Jueves.</p>
        </div>
      </div>

      <!-- Banco Galicia -->
      <div class="col-md-4">
        <div class="benefit-card p-4">
          <div class="d-flex align-items-center mb-3">
            <i class="bi bi-calendar-check text-warning fs-2 me-3"></i>
            <div>
              <h5 class="fw-bold mb-1">3 cuotas sin interés</h5>
              <p class="text-muted small mb-0">Ver legales</p>
            </div>
          </div>
          <p class="small mb-0">En toda la compra. Válido de Jueves a Domingo.</p>
        </div>
      </div>

      <!-- Cencopay -->
      <div class="col-md-4">
        <div class="benefit-card p-4">
          <div class="d-flex align-items-center mb-3">
            <i class="bi bi-wallet2 text-success fs-2 me-3"></i>
            <div>
              <h5 class="fw-bold mb-1">Exclusivo Online</h5>
              <p class="text-muted small mb-0">Ver legales</p>
            </div>
          </div>
          <p class="small mb-0">3 Cuotas Sin Interés en toda la compra</p>
        </div>
      </div>
    </div>
  </div>

  <!-- ÚLTIMOS PRODUCTOS -->
  <div class="container">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2 class="fw-bold mb-0">
        <i class="bi bi-fire text-danger me-2"></i>Últimos Productos
      </h2>
      <a href="{% url 'productos:product_list' %}" class="btn btn-custom-gray">
        Ver todos <i class="bi bi-arrow-right ms-1"></i>
      </a>
    </div>

    <div class="row g-4">
      {% for product in products %}
        <div class="col-md-4 col-lg-3">
          <a href="{% url 'productos:product_detail' product.pk %}" class="text-decoration-none">
            <div class="product-card card h-100 border-0 shadow-sm">
              {% if product.imagen %}
                <img src="{{ product.imagen.url }}" class="card-img-top" alt="{{ product.nombre }}">
              {% else %}
                <div class="bg-secondary d-flex align-items-center justify-content-center product-image-placeholder">
                  <i class="bi bi-image text-white fs-1"></i>
                </div>
              {% endif %}
              
              <div class="card-body">
                <h5 class="card-title fw-bold text-dark">{{ product.nombre }}</h5>
                <p class="card-text text-muted small">{{ product.descripcion|truncatewords:15 }}</p>
                <div class="d-flex justify-content-between align-items-center mt-3">
                  <span class="fw-bold fs-5 text-dark">${{ product.precio }}</span>
                  <span class="btn-view-more">
                    Ver más <i class="bi bi-arrow-right ms-1"></i>
                  </span>
                </div>
              </div>
              
              <div class="red-accent-line"></div>
            </div>
          </a>
        </div>
      {% empty %}
        <div class="col-12">
          <div class="text-center py-5">
            <i class="bi bi-inbox fs-1 text-muted mb-3"></i>
            <p class="text-muted fs-5">No hay productos publicados todavía.</p>
            <a href="{% url 'productos:product_create' %}" class="btn btn-custom-gray mt-3">
              <i class="bi bi-plus-circle me-2"></i>Publicar primero
            </a>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
{% endif %}

<style>
  /* Banner Carousel */
  .banner-slide {
    min-height: 400px;
    border-radius: 15px;
    transition: transform 0.3s ease;
  }

  .banner-slide:hover {
    transform: scale(1.02);
  }

  .banner-btn {
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
  }

  .banner-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
  }

  .discount-badge {
    background: white;
    color: #E4002B;
    display: inline-block;
    padding: 1.5rem 2rem;
    border-radius: 15px;
    text-align: center;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
  }

  .carousel-control-prev-icon,
  .carousel-control-next-icon {
    background-color: rgba(0, 0, 0, 0.5);
    border-radius: 50%;
    padding: 20px;
  }

  /* Categorías */
  .category-card {
    border-radius: 15px;
    overflow: hidden;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }

  .category-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 12px 35px rgba(228, 0, 43, 0.3);
  }

  .category-image {
    height: 250px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
  }

  .category-overlay {
    color: white;
    text-align: center;
    z-index: 2;
    transition: transform 0.3s ease;
  }

  .category-card:hover .category-overlay {
    transform: scale(1.1);
  }

  /* Benefit Cards */
  .benefit-card {
    background: white;
    border-radius: 15px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    transition: all 0.3s ease;
    height: 100%;
  }

  .benefit-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
  }

  /* Botón gris con línea roja */
  .btn-custom-gray {
    background: linear-gradient(to bottom, #f8f9fa 0%, #f8f9fa calc(100% - 4px), #E4002B calc(100% - 4px), #E4002B 100%);
    color: #212529;
    border: 1px solid #dee2e6;
    padding: 0.5rem 1.5rem;
    font-weight: 600;
    border-radius: 8px;
    transition: all 0.3s ease;
  }

  .btn-custom-gray:hover {
    background: linear-gradient(to bottom, #e9ecef 0%, #e9ecef calc(100% - 4px), #B8001F calc(100% - 4px), #B8001F 100%);
    color: #000;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }

  /* Card de producto */
  .product-card {
    border-radius: 15px;
    overflow: hidden;
    transition: all 0.3s ease;
    position: relative;
    cursor: pointer;
  }

  .product-card .card-img-top {
    height: 200px;
    object-fit: cover;
    transition: transform 0.3s ease;
  }

  .product-image-placeholder {
    height: 200px;
  }

  .product-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 35px rgba(0, 0, 0, 0.15) !important;
  }

  .product-card:hover .card-img-top {
    transform: scale(1.05);
  }

  .red-accent-line {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 5px;
    background: linear-gradient(90deg, #E4002B 0%, #B8001F 100%);
    transition: height 0.3s ease;
  }

  .product-card:hover .red-accent-line {
    height: 6px;
  }

  .btn-view-more {
    color: #6c757d;
    font-size: 0.9rem;
    font-weight: 600;
    transition: color 0.3s ease;
  }

  .product-card:hover .btn-view-more {
    color: #E4002B;
  }

  .product-card:hover .fs-5 {
    color: #E4002B !important;
    transition: color 0.3s ease;
  }
</style>

<script>
  // Auto-scroll del carousel cada 5 segundos
  var myCarousel = document.querySelector('#offersCarousel')
  var carousel = new bootstrap.Carousel(myCarousel, {
    interval: 5000,
    ride: 'carousel'
  })
</script>
{% endblock %}